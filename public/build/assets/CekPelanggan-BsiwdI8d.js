import{m as g,p as G,B as Se,h as r,b as U,i as p,w as A,a as e,o as n,t as i,c as J,d as T,l as V,e as u,g as y,v as S,y as q,F as j,r as Y,f as de,j as pe,n as se,C as D,k as Le}from"./app-kXIjK14U.js";import{_ as ze}from"./AppLayout-DG1mUoFb.js";import{_ as Te}from"./InfoCicilan-BdRjpXp0.js";/* empty css            */const Ve={class:"py-12"},De={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},Ne={class:"mb-6"},Pe={class:"flex flex-col sm:flex-row sm:justify-between sm:items-center gap-4"},$e={class:"hidden lg:flex gap-2 xl:gap-3"},Ie={class:"lg:hidden relative"},Re={key:0,class:"absolute right-0 mt-2 w-56 bg-white rounded-lg shadow-xl z-50 border border-gray-200"},He={class:"py-2"},Fe={key:0,class:"mb-6 bg-blue-50 border border-blue-200 text-blue-700 px-4 py-3 rounded-lg"},Ue={class:"bg-white rounded-lg shadow-md p-4 sm:p-6 mb-6"},Ee={class:"space-y-3"},Ge={class:"w-full"},Ye={class:"grid grid-cols-1 sm:grid-cols-3 gap-3"},We=["value"],Ke=["value"],Oe={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 mb-6"},Je={class:"bg-white rounded-lg shadow-md p-4"},qe={class:"flex items-center"},Qe={class:"ml-3 sm:ml-4"},Xe={class:"text-xl sm:text-2xl font-bold text-gray-900"},Ze={class:"bg-white rounded-lg shadow-md p-6"},ea={class:"flex items-center"},aa={class:"ml-4"},ta={class:"text-2xl font-bold text-gray-900"},sa={class:"bg-white rounded-lg shadow-md p-6"},la={class:"flex items-center"},na={class:"ml-4"},ra={class:"text-2xl font-bold text-gray-900"},oa={class:"bg-white rounded-lg shadow-md overflow-hidden"},ia={class:"overflow-x-auto"},ua={class:"min-w-full divide-y divide-gray-200"},da={class:"bg-blue-800"},pa={key:0,class:"px-6 py-3 text-left text-xs font-medium text-white uppercase tracking-wider"},ma={class:"bg-white divide-y divide-gray-200"},ga={key:0},ba=["colspan"],xa={class:"px-6 py-4 whitespace-nowrap"},va={class:"text-sm font-medium text-gray-900"},ca={class:"px-6 py-4 whitespace-nowrap"},ha={class:"text-sm font-medium text-gray-900"},fa={class:"px-6 py-4 whitespace-nowrap"},ya={class:"text-sm text-gray-900"},ka={class:"px-6 py-4 whitespace-nowrap"},wa=["href"],_a={key:1,class:"text-sm text-gray-400"},Ma={class:"px-6 py-4 whitespace-nowrap"},Ca={class:"text-sm text-gray-900"},Ba={class:"px-6 py-4 whitespace-nowrap"},ja={class:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-indigo-100 text-indigo-800"},Aa={class:"px-6 py-4 whitespace-nowrap"},Sa={key:0,class:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-purple-100 text-purple-800"},La={key:1,class:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800"},za={class:"px-6 py-4 whitespace-nowrap"},Ta={key:0,class:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800"},Va={key:1,class:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800"},Da={class:"px-6 py-4 whitespace-nowrap"},Na={key:0,class:"flex flex-col"},Pa={class:"text-xs text-purple-600 font-medium"},$a={key:1,class:"flex flex-col"},Ia={key:0,class:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800 mb-1"},Ra={key:1,class:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800 mb-1"},Ha={key:2,class:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800 mb-1"},Fa={key:3,class:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800 mb-1"},Ua={class:"text-xs text-gray-500"},Ea={class:"px-6 py-4 whitespace-nowrap text-sm"},Ga=["onClick"],Ya={key:1,class:"text-gray-400 text-xs"},Wa={class:"px-6 py-4 whitespace-nowrap text-sm"},Ka={key:1,class:"text-gray-400 text-xs"},Oa={class:"px-6 py-4 whitespace-nowrap text-sm"},Ja=["href"],qa=["href"],Qa={key:2,class:"text-gray-400 text-xs"},Xa={key:0,class:"px-6 py-4 whitespace-nowrap text-sm"},Za={class:"flex gap-2 items-center"},et=["href"],at=["onClick"],tt=["onClick"],st={class:"flex items-center justify-center min-h-screen px-4 py-6"},lt={class:"relative bg-white rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] flex flex-col"},nt={class:"bg-blue-800 text-white px-4 sm:px-6 py-3 sm:py-4 rounded-t-lg flex justify-between items-center flex-shrink-0"},rt={class:"text-lg sm:text-xl font-bold"},ot={class:"p-4 sm:p-6 overflow-y-auto flex-1"},it={class:"mb-6 bg-gray-50 rounded-lg p-3 sm:p-4"},ut={key:0,class:"mb-4 bg-yellow-50 border border-yellow-300 rounded-lg p-3"},dt={class:"flex items-start"},pt={class:"text-sm text-yellow-700"},mt={key:1,class:"mb-4 bg-purple-50 border border-purple-200 rounded-lg p-3"},gt={key:3,class:"mb-4 bg-amber-50 border border-amber-300 rounded-lg p-4"},bt={class:"space-y-1 text-sm mb-3 bg-white rounded-lg border border-amber-200 p-3"},xt={class:"text-amber-800"},vt={class:"font-semibold text-amber-900"},ct={class:"flex justify-between pt-2 font-bold border-t-2 border-amber-200 mt-1"},ht={class:"text-amber-900"},ft={key:0,class:"mt-2 pt-2 border-t border-amber-200"},yt=["max","placeholder"],kt={class:"text-xs text-amber-600 mt-1"},wt={class:"grid grid-cols-1 sm:grid-cols-2 gap-4 sm:gap-6"},_t={class:"col-span-1"},Mt={class:"relative rounded-md shadow-sm"},Ct={key:0,class:"mt-1 text-xs text-red-600"},Bt={class:"col-span-1"},jt={class:"relative rounded-md shadow-sm"},At={key:0,class:"mt-1 text-xs text-red-600"},St={key:0,class:"col-span-1 sm:col-span-2 bg-yellow-50 border border-yellow-300 rounded-lg p-3"},Lt={class:"col-span-1 space-y-2"},zt={key:0,class:"mt-1 text-xs text-red-600"},Tt={class:"col-span-1 space-y-2"},Vt={key:0,class:"mt-1 text-xs text-red-600"},Dt={key:0,class:"text-red-600 text-sm mt-1"},Nt={key:1,class:"text-xs text-purple-600 mt-1 font-medium"},Pt={key:2,class:"text-xs text-gray-500 mt-1"},$t={class:"flex items-center space-x-3 cursor-pointer"},It={class:"flex items-center space-x-3 cursor-pointer"},Rt={class:"text-xs text-amber-600 font-medium"},Ht={class:"block text-sm font-medium text-gray-700 mb-2"},Ft={key:0,class:"text-blue-600 text-xs"},Ut=["readonly"],Et={key:0,class:"text-red-600 text-sm mt-1"},Gt={key:1,class:"text-xs text-blue-600 mt-1"},Yt={class:"text-xs text-gray-500 mt-1"},Wt={key:0,class:"text-amber-600 block mt-1 font-medium"},Kt=["disabled"],Ot={key:0,class:"text-center py-8"},Jt={key:1,class:"text-center py-8"},qt={key:2},Qt={class:"grid grid-cols-3 gap-3 mb-4 p-3 bg-gradient-to-r from-blue-50 to-indigo-50 rounded-xl border border-blue-100"},Xt={class:"text-center"},Zt={class:"text-xl font-bold text-blue-700"},es={class:"text-center border-x border-blue-200"},as={class:"text-sm font-bold text-green-700"},ts={class:"text-center"},ss={class:"text-xl font-bold text-purple-700"},ls={class:"space-y-3"},ns={class:"flex items-center justify-between px-4 py-3 bg-gradient-to-r from-blue-600 to-indigo-600 text-white"},rs={class:"flex items-center gap-3"},os={class:"font-bold text-base"},is={class:"text-xs text-blue-200"},us={class:"flex items-center gap-2"},ds={class:"text-xs text-blue-200 bg-white/10 rounded px-2 py-1"},ps={class:"p-4"},ms={class:"grid grid-cols-1 sm:grid-cols-2 gap-4"},gs={class:"bg-slate-50 rounded-xl p-3 border border-slate-100"},bs={class:"flex items-center gap-3 mb-3"},xs={class:"flex-1 text-center bg-white rounded-lg py-2 px-3 border border-slate-200 shadow-sm"},vs={class:"text-xl font-bold text-gray-700 font-mono tracking-wider"},cs={class:"flex flex-col items-center gap-1"},hs={class:"text-xs font-bold text-blue-600 bg-blue-50 rounded-full px-2 py-0.5 border border-blue-200"},fs={class:"flex-1 text-center bg-white rounded-lg py-2 px-3 border border-slate-200 shadow-sm"},ys={class:"text-xl font-bold text-gray-700 font-mono tracking-wider"},ks={class:"text-center py-1.5 bg-blue-50 rounded-lg border border-blue-100"},ws={class:"text-sm font-bold text-blue-800"},_s={key:0,class:"mt-2 flex items-center gap-1.5 text-xs text-gray-400 pl-1"},Ms={class:"bg-slate-50 rounded-xl border border-slate-100 overflow-hidden"},Cs={class:"flex items-center justify-between px-3 py-2.5 border-b border-slate-100"},Bs={key:0,class:"text-xs text-gray-400 mt-0.5 pl-4"},js={class:"text-sm font-semibold text-gray-800"},As={class:"flex items-center justify-between px-3 py-2.5 border-b border-slate-100"},Ss={key:0,class:"flex items-center justify-between px-3 py-2.5 border-b border-red-100 bg-red-100"},Ls={class:"text-sm font-bold text-red-700"},zs={class:"flex items-center justify-between px-3 py-3 bg-gradient-to-r from-blue-600 to-indigo-600"},Ts={class:"text-base font-bold text-white"},Vs={class:"flex flex-col sm:flex-row sm:items-center justify-between gap-3 px-4 py-2.5 bg-gray-50 border-t border-gray-200"},Ds={class:"text-xs text-gray-400 order-2 sm:order-1 font-medium"},Ns={class:"flex flex-wrap gap-2 order-1 sm:order-2"},Ps=["onClick"],$s=["onClick"],Is=["onClick"],Rs=["onClick"],Hs={class:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0"},Fs={class:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4"},Us={class:"flex justify-between items-center mb-4"},Es={class:"text-lg font-bold text-gray-900"},Gs={key:0,class:"mt-2 relative"},Ys={key:0,class:"absolute inset-0 flex items-center justify-center bg-white bg-opacity-90 z-10 rounded-lg"},Ws=["src","alt"],Ks={key:1,class:"mt-2 p-8 text-center bg-red-50 rounded-lg"},Os={class:"text-sm text-red-700 mb-4"},Js={key:2,class:"mt-2 p-8 text-center bg-gray-50 rounded-lg"},qs={class:"mt-4 flex justify-between items-center"},Qs={class:"text-sm text-gray-600"},Xs=["href"],sl={__name:"CekPelanggan",props:{pelangganList:{type:Array,default:()=>[]},pembayaranList:{type:Array,default:()=>[]},bulanIni:{type:String,default:""},bulanFilter:{type:String,default:""},stats:{type:Object,default:()=>({totalPembayaran:0,totalPemasukan:0,rataRata:0})}},setup(me){const N=me,m=g(N.pelangganList||[]),R=g(""),H=g("all"),P=g("all"),F=g("all"),L=g(!1),W=g(!1),C=g(null),$=g(!1),E=g(!1),Q=g("");g("pelanggan");const le=g(""),ne=g("all"),X=g(!1),x=g(null),k=g([]),Z=g(!1),K=g(!1),I=g(null),v=g([]),l=g({bulan_bayar:N.bulanIni||"",tanggal_bayar:new Date().toISOString().split("T")[0],meteran_sebelum:null,meteran_sesudah:null,tarif_per_kubik:2e3,biaya_abunemen_nominal:3e3,abunemen:!1,tunggakan:0,jumlah_kubik:0,jumlah_bayar:0,keterangan:"",status_bayar:"SUDAH_BAYAR",bayar_tunggakan:!1,jumlah_bayar_tunggakan:0,id_tunggakan:[]}),M=()=>{if(l.value.status_bayar==="TUNGGAKAN"){const o=parseFloat(l.value.meteran_sebelum)||0,d=(parseFloat(l.value.meteran_sesudah)||0)-o;l.value.jumlah_kubik=d>=0?d:0,l.value.jumlah_bayar=0;return}if(l.value.status_bayar==="CICILAN"){const o=parseFloat(l.value.meteran_sebelum)||0,d=(parseFloat(l.value.meteran_sesudah)||0)-o;l.value.jumlah_kubik=d>=0?d:0;return}const s=parseFloat(l.value.meteran_sebelum)||0,t=(parseFloat(l.value.meteran_sesudah)||0)-s;if(l.value.jumlah_kubik=t>=0?t:0,l.value.jumlah_kubik>0||l.value.abunemen||l.value.tunggakan>0)if(x.value?.kategori==="sosial")l.value.jumlah_bayar=0;else{const o=parseFloat(l.value.tarif_per_kubik)||2e3,c=parseFloat(l.value.biaya_abunemen_nominal)||3e3,d=Math.round(l.value.jumlah_kubik*o),f=l.value.abunemen?c:0,b=l.value.bayar_tunggakan?parseFloat(l.value.jumlah_bayar_tunggakan||0):0;l.value.jumlah_bayar=d+f+b}else l.value.jumlah_bayar=0},ge=()=>{if(l.value.bayar_tunggakan){const s=v.value.reduce((a,t)=>a+(t.sisa_tagihan||0),0);l.value.jumlah_bayar_tunggakan=s}else l.value.jumlah_bayar_tunggakan=0;M()},h=g({}),be=G(()=>m.value.filter(s=>s.status_aktif).length),xe=G(()=>{const s=[],a=["Januari","Februari","Maret","April","Mei","Juni","Juli","Agustus","September","Oktober","November","Desember"],t=new Date;for(let o=0;o<12;o++){const c=new Date(t.getFullYear(),t.getMonth()-o,1),d=c.getFullYear(),f=c.getMonth(),b=`${d}-${String(f+1).padStart(2,"0")}`,_=`${a[f]} ${d}`;s.push({value:b,label:_})}return s}),ee=G(()=>{let s=m.value;if(H.value==="aktif"?s=s.filter(a=>a.status_aktif):H.value==="nonaktif"&&(s=s.filter(a=>!a.status_aktif)),F.value!=="all"){const a=F.value.toLowerCase().trim().replace(/_/g," ").replace(/\s+/g," ");s=s.filter(t=>(t.wilayah||"").toLowerCase().trim().replace(/_/g," ").replace(/\s+/g," ")===a)}if(R.value){const a=R.value.toLowerCase().trim();s=s.filter(t=>(t.id_pelanggan||"").toLowerCase().includes(a)||(t.nama_pelanggan||"").toLowerCase().includes(a)||(t.wilayah||"").toLowerCase().includes(a)||t.rt&&t.rt.toString().includes(a)||t.rw&&t.rw.toString().includes(a))}return s}),z=s=>{const a=P.value!=="all"?P.value:N.bulanIni,t=["Januari","Februari","Maret","April","Mei","Juni","Juli","Agustus","September","Oktober","November","Desember"],[o,c]=a.split("-"),d=`${t[parseInt(c)-1]} ${o}`;if(P.value==="all"&&s.status_bayar)return{sudah_bayar:s.status_bayar==="SUDAH_BAYAR",status:s.status_bayar,bulan:d};const f=s.bulan_dibayar&&s.bulan_dibayar.includes(a);return{sudah_bayar:f,status:f?"SUDAH_BAYAR":"BELUM_BAYAR",bulan:d}},ve=G(()=>{const s=new Set;return m.value.forEach(a=>{if(a.wilayah){const t=a.wilayah.trim().replace(/_/g," ");s.add(t)}}),Array.from(s).sort()});G(()=>{let s=N.pembayaranList||[];if(le.value){const a=le.value.toLowerCase().trim();s=s.filter(t=>t.id_pelanggan.toLowerCase().includes(a)||t.nama_pelanggan.toLowerCase().includes(a))}if(ne.value!=="all"){const a=ne.value.toLowerCase().trim().replace(/_/g," ").replace(/\s+/g," ");s=s.filter(t=>(t.wilayah||"").toLowerCase().trim().replace(/_/g," ").replace(/\s+/g," ")===a)}return s});const ce=async s=>{x.value=s,X.value=!0,Z.value=!0,h.value={};const a=new Date,t=N.bulanIni||a.toISOString().slice(0,7),o=a.toISOString().split("T")[0];try{const c=await D.get(`/pelanggan/${s.id}/pembayaran`);k.value=c.data.pembayarans;const d=new Date,f=d.getFullYear(),b=d.getMonth()+1;let _=t;for(let w=1;w<=b;w++){const B=`${f}-${String(w).padStart(2,"0")}`;if(!k.value.some(te=>te.bulan_bayar===B)){_=B;break}}l.value={bulan_bayar:_,tanggal_bayar:o,meteran_sebelum:0,meteran_sesudah:0,abunemen:!1,tunggakan:0,jumlah_kubik:0,jumlah_bayar:0,keterangan:"",status_bayar:"BELUM_BAYAR",bayar_tunggakan:!1},await ae(_);try{const w=await D.get(`/api/tagihan-bulanan/${s.id}/tunggakan`);if(w.data&&w.data.tunggakan){v.value=w.data.tunggakan.filter(O=>O.bulan<_);const B=v.value.reduce((O,te)=>O+(te.sisa_tagihan||0),0);B>0&&(l.value.tunggakan=B,l.value.bayar_tunggakan=!0,l.value.jumlah_bayar_tunggakan=B)}}catch(w){console.error("Error loading tunggakan:",w),v.value=[]}l.value.tunggakan>0&&M()}catch(c){console.error("Error loading data:",c)}finally{Z.value=!1}},he=s=>{if(!s)return null;let[a,t]=s.split("-").map(Number);return t=t-1,t===0&&(a-=1,t=12),`${a}-${String(t).padStart(2,"0")}`},ae=async s=>{if(x.value){I.value=null;try{let a;try{a=await D.get(`/api/tagihan-bulanan/${x.value.id}/${s}`)}catch(o){if(o.response&&o.response.status===404)a={data:{tagihan:null}};else throw o}if(a.data&&a.data.tagihan){const o=a.data.tagihan;I.value=o,l.value.meteran_sebelum=o.meteran_sebelum,l.value.meteran_sesudah=o.meteran_sesudah,l.value.jumlah_kubik=o.pemakaian_kubik,o.ada_abunemen&&(l.value.abunemen=!0),M();return}const t=he(s);if(t){let o=!1,c=0;try{const d=await D.get(`/api/tagihan-bulanan/${x.value.id}/${t}`);d.data&&d.data.tagihan&&d.data.tagihan.meteran_sesudah>0&&(c=d.data.tagihan.meteran_sesudah,o=!0)}catch(d){d.response&&d.response.status!==404&&console.error("Error fetching prev tagihan:",d)}if(!o){const d=k.value.find(f=>f.bulan_bayar===t);d&&d.meteran_sesudah>0&&(c=d.meteran_sesudah,o=!0)}if(o){l.value.meteran_sebelum=c,l.value.meteran_sesudah=0,l.value.jumlah_kubik=0,M();return}}l.value.meteran_sebelum=0,l.value.meteran_sesudah=0,l.value.jumlah_kubik=0,M()}catch(a){console.error("Error fetching meteran data:",a)}}};Se(()=>l.value.bulan_bayar,s=>{s&&x.value&&ae(s)});const re=()=>{X.value=!1,x.value=null,k.value=[],h.value={}},fe=async()=>{if(x.value){h.value={},K.value=!0;try{const s={...l.value};l.value.bayar_tunggakan&&v.value.length>0&&(s.id_tunggakan=v.value.map(b=>b.id));const a=await D.post(`/pelanggan/${x.value.id}/pembayaran`,s);k.value.unshift(a.data.pembayaran);const t=m.value.findIndex(b=>b.id===x.value.id);if(t!==-1){m.value[t].bulan_dibayar||(m.value[t].bulan_dibayar=[]),m.value[t].bulan_dibayar.includes(a.data.pembayaran.bulan_bayar)||m.value[t].bulan_dibayar.push(a.data.pembayaran.bulan_bayar),m.value[t].status_bayar=a.data.pembayaran.status_tagihan||"BELUM_BAYAR",m.value[t].sudah_bayar=m.value[t].status_bayar==="SUDAH_BAYAR";const b=new Date(a.data.pembayaran.tanggal_bayar);m.value[t].tanggal_bayar=b.toLocaleDateString("id-ID",{day:"2-digit",month:"2-digit",year:"numeric"}),m.value[t].jumlah_bayar=a.data.pembayaran.jumlah_bayar,a.data.pembayaran.status_tagihan==="TUNGGAKAN"||a.data.pembayaran.sisa_tunggakan>0?m.value[t].has_tunggakan=!0:s.bayar_tunggakan&&s.jumlah_bayar_tunggakan>=s.tunggakan&&(m.value[t].has_tunggakan=!1)}v.value=[],I.value=null;const o=new Date,c=o.getFullYear(),d=o.getMonth()+1;let f=N.bulanIni||o.toISOString().slice(0,7);for(let b=1;b<=d;b++){const _=`${c}-${String(b).padStart(2,"0")}`;if(!k.value.some(B=>B.bulan_bayar===_)){f=_;break}}l.value={bulan_bayar:f,tanggal_bayar:new Date().toISOString().split("T")[0],meteran_sebelum:null,meteran_sesudah:null,abunemen:!1,tunggakan:0,jumlah_kubik:null,jumlah_bayar:null,keterangan:"",status_bayar:"BELUM_BAYAR",bayar_tunggakan:!1,jumlah_bayar_tunggakan:0,id_tunggakan:[]},await ae(f);try{const b=await D.get(`/api/tagihan-bulanan/${x.value.id}/tunggakan`);if(b.data?.tunggakan){v.value=b.data.tunggakan.filter(w=>w.bulan<f);const _=v.value.reduce((w,B)=>w+(B.sisa_tagihan||0),0);_>0&&(l.value.tunggakan=_,l.value.bayar_tunggakan=!0,l.value.jumlah_bayar_tunggakan=_,M())}}catch{}alert("Pembayaran berhasil ditambahkan!")}catch(s){s.response?.status===422?s.response.data.errors?h.value=s.response.data.errors:s.response.data.message&&alert(s.response.data.message):alert("Terjadi kesalahan saat menyimpan pembayaran")}finally{K.value=!1}}},ye=async s=>{if(confirm("Apakah Anda yakin ingin menghapus pembayaran ini?"))try{const a=k.value.find(t=>t.id===s);if(await D.delete(`/pembayaran/${s}`),k.value=k.value.filter(t=>t.id!==s),a){const t=m.value.findIndex(o=>o.id===x.value.id);t!==-1&&(m.value[t].bulan_dibayar&&(m.value[t].bulan_dibayar=m.value[t].bulan_dibayar.filter(o=>o!==a.bulan_bayar)),a.bulan_bayar===N.bulanIni&&(m.value[t].sudah_bayar=!1,m.value[t].tanggal_bayar=null,m.value[t].jumlah_bayar=null))}alert("Pembayaran berhasil dihapus")}catch{alert("Terjadi kesalahan saat menghapus pembayaran")}},ke=async s=>{try{const a=await D.post(`/pembayaran/${s}/send-receipt`);a.data.wa_link&&(window.open(a.data.wa_link,"_blank"),alert(`Struk berhasil digenerate!

Pelanggan: ${a.data.pelanggan_nama}
No. WhatsApp: ${a.data.no_whatsapp}

Jendela WhatsApp akan terbuka. Silakan kirim pesan dengan struk pembayaran.`))}catch(a){a.response?.status===422?alert(a.response.data.message||"Nomor WhatsApp pelanggan tidak tersedia"):a.response?.status===404?alert(a.response.data.message||"Data pelanggan tidak ditemukan"):(console.error("Error sending receipt:",a),alert("Terjadi kesalahan saat mengirim struk. Silakan coba lagi."))}},we=s=>{window.open(`/pembayaran/${s}/download-pdf`,"_blank")},_e=s=>{window.open(`/pembayaran/${s}/print`,"_blank")},Me=s=>{console.log("Opening modal for:",s?.nama_pelanggan),console.log("Foto URL:",s?.foto_rumah_url),C.value=s,E.value=!1,Q.value="",W.value=!0,s?.foto_rumah_url?($.value=!0,console.log("Photo loading set to true"),setTimeout(()=>{$.value&&(console.log("Timeout: forcing loading to false"),$.value=!1)},3e3)):$.value=!1},Ce=()=>{console.log("Photo loaded successfully!"),$.value=!1},Be=s=>{console.error("Error loading photo:",s),$.value=!1,E.value=!0,Q.value="Gagal memuat foto. File mungkin tidak ditemukan atau storage link belum dibuat."},oe=()=>{const s=new URLSearchParams({search:R.value,status:H.value,bulan:P.value,wilayah:F.value});window.location.href=`/cek-pelanggan/export-excel?${s.toString()}`},ie=()=>{const s=new URLSearchParams({search:R.value,status:H.value,bulan:P.value,wilayah:F.value});window.location.href=`/cek-pelanggan/export-pdf?${s.toString()}`},ue=s=>{if(!s)return"-";const[a,t]=s.split("-");return`${["Januari","Februari","Maret","April","Mei","Juni","Juli","Agustus","September","Oktober","November","Desember"][parseInt(t)-1]} ${a}`},je=s=>s?new Date(s).toLocaleDateString("id-ID",{day:"2-digit",month:"2-digit",year:"numeric"}):"-",Ae=s=>{confirm(`Apakah Anda yakin ingin menghapus pelanggan ${s.nama_pelanggan}?`)&&Le.delete(`/pelanggan/${s.id}`)};return(s,a)=>(n(),r(j,null,[U(ze,null,{default:A(()=>[p("",!0),e("div",Ve,[e("div",De,[e("div",Ne,[e("div",Pe,[a[36]||(a[36]=e("div",null,[e("h1",{class:"text-2xl sm:text-3xl font-bold text-gray-900"},"Data Pelanggan KP-SPAMS"),e("p",{class:"text-sm sm:text-base text-gray-600"},"Daftar lengkap pelanggan air bersih desa")],-1)),e("div",$e,[U(T(V),{href:"/qr-code/bulk-preview",class:"inline-flex items-center px-3 xl:px-4 py-2 bg-green-600 text-white rounded-lg font-medium hover:bg-green-700 transition text-sm"},{default:A(()=>[...a[25]||(a[25]=[e("svg",{class:"w-4 h-4 xl:w-5 xl:h-5 xl:mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v1m6 11h2m-6 0h-2v4m0-11v3m0 0h.01M12 12h4.01M16 20h4M4 12h4m12 0h.01M5 8h2a1 1 0 001-1V5a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1zm12 0h2a1 1 0 001-1V5a1 1 0 00-1-1h-2a1 1 0 00-1 1v2a1 1 0 001 1zM5 20h2a1 1 0 001-1v-2a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1z"})],-1),e("span",{class:"hidden xl:inline"},"Print QR",-1)])]),_:1}),U(T(V),{href:"/pembayaran",class:"inline-flex items-center px-3 xl:px-4 py-2 bg-purple-600 text-white rounded-lg font-medium hover:bg-purple-700 transition text-sm"},{default:A(()=>[...a[26]||(a[26]=[e("svg",{class:"w-4 h-4 xl:w-5 xl:h-5 xl:mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"})],-1),e("span",{class:"hidden xl:inline"},"Riwayat",-1)])]),_:1}),e("button",{onClick:oe,class:"inline-flex items-center px-3 xl:px-4 py-2 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 transition text-sm"},[...a[27]||(a[27]=[e("svg",{class:"w-4 h-4 xl:w-5 xl:h-5 xl:mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1),e("span",{class:"hidden xl:inline"},"Excel",-1)])]),e("button",{onClick:ie,class:"inline-flex items-center px-3 xl:px-4 py-2 bg-red-600 text-white rounded-lg font-medium hover:bg-red-700 transition text-sm"},[...a[28]||(a[28]=[e("svg",{class:"w-4 h-4 xl:w-5 xl:h-5 xl:mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"})],-1),e("span",{class:"hidden xl:inline"},"PDF",-1)])]),s.$page.props.auth?.user?(n(),J(T(V),{key:0,href:"/pelanggan/create",class:"inline-flex items-center px-4 xl:px-6 py-2 bg-blue-800 text-white rounded-lg font-semibold hover:bg-blue-900 transition text-sm"},{default:A(()=>[...a[29]||(a[29]=[e("svg",{class:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),e("span",{class:"hidden xl:inline"},"Tambah",-1),e("span",{class:"xl:hidden"},"+",-1)])]),_:1})):p("",!0)]),e("div",Ie,[e("button",{onClick:a[0]||(a[0]=t=>L.value=!L.value),class:"w-full sm:w-auto inline-flex items-center justify-center px-4 py-2 bg-blue-800 text-white rounded-lg font-semibold hover:bg-blue-900 transition"},[...a[30]||(a[30]=[e("svg",{class:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 6h16M4 12h16M4 18h16"})],-1),u(" Menu Aksi ",-1)])]),L.value?(n(),r("div",Re,[e("div",He,[U(T(V),{href:"/qr-code/bulk-preview",class:"flex items-center px-4 py-3 text-gray-700 hover:bg-gray-50 transition",onClick:a[1]||(a[1]=t=>L.value=!1)},{default:A(()=>[...a[31]||(a[31]=[e("svg",{class:"w-5 h-5 mr-3 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v1m6 11h2m-6 0h-2v4m0-11v3m0 0h.01M12 12h4.01M16 20h4M4 12h4m12 0h.01M5 8h2a1 1 0 001-1V5a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1zm12 0h2a1 1 0 001-1V5a1 1 0 00-1-1h-2a1 1 0 00-1 1v2a1 1 0 001 1zM5 20h2a1 1 0 001-1v-2a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1z"})],-1),u(" Print QR Code ",-1)])]),_:1}),U(T(V),{href:"/pembayaran",class:"flex items-center px-4 py-3 text-gray-700 hover:bg-gray-50 transition",onClick:a[2]||(a[2]=t=>L.value=!1)},{default:A(()=>[...a[32]||(a[32]=[e("svg",{class:"w-5 h-5 mr-3 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"})],-1),u(" Riwayat Pembayaran ",-1)])]),_:1}),e("button",{onClick:a[3]||(a[3]=t=>{oe(),L.value=!1}),class:"w-full flex items-center px-4 py-3 text-gray-700 hover:bg-gray-50 transition"},[...a[33]||(a[33]=[e("svg",{class:"w-5 h-5 mr-3 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1),u(" Export Excel ",-1)])]),e("button",{onClick:a[4]||(a[4]=t=>{ie(),L.value=!1}),class:"w-full flex items-center px-4 py-3 text-gray-700 hover:bg-gray-50 transition"},[...a[34]||(a[34]=[e("svg",{class:"w-5 h-5 mr-3 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"})],-1),u(" Export PDF ",-1)])]),s.$page.props.auth?.user?(n(),J(T(V),{key:0,href:"/pelanggan/create",class:"flex items-center px-4 py-3 text-gray-700 hover:bg-gray-50 transition border-t border-gray-100",onClick:a[5]||(a[5]=t=>L.value=!1)},{default:A(()=>[...a[35]||(a[35]=[e("svg",{class:"w-5 h-5 mr-3 text-blue-800",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),u(" Tambah Pelanggan ",-1)])]),_:1})):p("",!0)])])):p("",!0)])])]),s.$page.props.flash?.success?(n(),r("div",Fe,i(s.$page.props.flash.success),1)):p("",!0),e("div",Ue,[e("div",Ee,[e("div",Ge,[y(e("input",{type:"text","onUpdate:modelValue":a[6]||(a[6]=t=>R.value=t),placeholder:"Cari berdasarkan ID, nama, RT, atau RW...",class:"w-full px-4 py-2.5 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-800 focus:border-transparent"},null,512),[[S,R.value]])]),e("div",Ye,[y(e("select",{"onUpdate:modelValue":a[7]||(a[7]=t=>H.value=t),class:"w-full px-3 py-2.5 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-800 focus:border-transparent"},[...a[37]||(a[37]=[e("option",{value:"all"},"Semua Status",-1),e("option",{value:"aktif"},"Aktif",-1),e("option",{value:"nonaktif"},"Nonaktif",-1)])],512),[[q,H.value]]),y(e("select",{"onUpdate:modelValue":a[8]||(a[8]=t=>P.value=t),class:"w-full px-3 py-2.5 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-800 focus:border-transparent"},[a[38]||(a[38]=e("option",{value:"all"},"Semua Bulan",-1)),(n(!0),r(j,null,Y(xe.value,t=>(n(),r("option",{key:t.value,value:t.value},i(t.label),9,We))),128))],512),[[q,P.value]]),s.$page.props.auth.user.role!=="penarik"?y((n(),r("select",{key:0,"onUpdate:modelValue":a[9]||(a[9]=t=>F.value=t),class:"w-full px-3 py-2.5 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-800 focus:border-transparent"},[a[39]||(a[39]=e("option",{value:"all"},"Semua Wilayah",-1)),(n(!0),r(j,null,Y(ve.value,t=>(n(),r("option",{key:t,value:t},i(t),9,Ke))),128))],512)),[[q,F.value]]):p("",!0)])])]),e("div",Oe,[e("div",Je,[e("div",qe,[a[41]||(a[41]=e("div",{class:"p-2.5 rounded-full bg-blue-100 text-blue-600"},[e("svg",{class:"w-6 h-6 sm:w-8 sm:h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})])],-1)),e("div",Qe,[a[40]||(a[40]=e("p",{class:"text-xs sm:text-sm font-medium text-gray-500"},"Total Pelanggan",-1)),e("p",Xe,i(m.value.length),1)])])]),e("div",Ze,[e("div",ea,[a[43]||(a[43]=e("div",{class:"p-3 rounded-full bg-blue-100 text-blue-600"},[e("svg",{class:"w-8 h-8",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z","clip-rule":"evenodd"})])],-1)),e("div",aa,[a[42]||(a[42]=e("p",{class:"text-sm font-medium text-gray-500"},"Pelanggan Aktif",-1)),e("p",ta,i(be.value),1)])])]),e("div",sa,[e("div",la,[a[45]||(a[45]=e("div",{class:"p-3 rounded-full bg-purple-100 text-purple-600"},[e("svg",{class:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7"})])],-1)),e("div",na,[a[44]||(a[44]=e("p",{class:"text-sm font-medium text-gray-500"},"Hasil Pencarian",-1)),e("p",ra,i(ee.value.length),1)])])])]),e("div",oa,[e("div",ia,[e("table",ua,[e("thead",da,[e("tr",null,[a[46]||(a[46]=e("th",{class:"px-6 py-3 text-left text-xs font-medium text-white uppercase tracking-wider"},"ID Pelanggan",-1)),a[47]||(a[47]=e("th",{class:"px-6 py-3 text-left text-xs font-medium text-white uppercase tracking-wider"},"Nama",-1)),a[48]||(a[48]=e("th",{class:"px-6 py-3 text-left text-xs font-medium text-white uppercase tracking-wider"},"NIK",-1)),a[49]||(a[49]=e("th",{class:"px-6 py-3 text-left text-xs font-medium text-white uppercase tracking-wider"},"No. WhatsApp",-1)),a[50]||(a[50]=e("th",{class:"px-6 py-3 text-left text-xs font-medium text-white uppercase tracking-wider"},"RT / RW",-1)),a[51]||(a[51]=e("th",{class:"px-6 py-3 text-left text-xs font-medium text-white uppercase tracking-wider"},"Wilayah",-1)),a[52]||(a[52]=e("th",{class:"px-6 py-3 text-left text-xs font-medium text-white uppercase tracking-wider"},"Kategori",-1)),a[53]||(a[53]=e("th",{class:"px-6 py-3 text-left text-xs font-medium text-white uppercase tracking-wider"},"Status",-1)),a[54]||(a[54]=e("th",{class:"px-6 py-3 text-left text-xs font-medium text-white uppercase tracking-wider"},"Status Bayar",-1)),a[55]||(a[55]=e("th",{class:"px-6 py-3 text-left text-xs font-medium text-white uppercase tracking-wider"},"Foto Rumah",-1)),a[56]||(a[56]=e("th",{class:"px-6 py-3 text-left text-xs font-medium text-white uppercase tracking-wider"},"Lokasi",-1)),a[57]||(a[57]=e("th",{class:"px-6 py-3 text-left text-xs font-medium text-white uppercase tracking-wider"},"Google Maps",-1)),s.$page.props.auth?.user?(n(),r("th",pa,"Aksi")):p("",!0)])]),e("tbody",ma,[ee.value.length===0?(n(),r("tr",ga,[e("td",{colspan:s.$page.props.auth?.user?11:10,class:"px-6 py-12 text-center text-gray-500"},[...a[58]||(a[58]=[e("svg",{class:"mx-auto h-12 w-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9.172 16.172a4 4 0 015.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1),e("p",{class:"mt-2"},"Tidak ada data pelanggan yang ditemukan",-1)])],8,ba)])):p("",!0),(n(!0),r(j,null,Y(ee.value,t=>(n(),r("tr",{key:t.id_pelanggan,class:"hover:bg-gray-50 transition-colors"},[e("td",xa,[e("div",va,i(t.id_pelanggan),1)]),e("td",ca,[e("div",ha,i(t.nama_pelanggan),1)]),e("td",fa,[e("div",ya,i(t.nik||"-"),1)]),e("td",ka,[t.no_whatsapp?(n(),r("a",{key:0,href:`https://wa.me/${t.no_whatsapp.replace(/^0/,"62")}`,target:"_blank",class:"inline-flex items-center text-blue-600 hover:text-blue-800 text-sm"},[a[59]||(a[59]=e("svg",{class:"w-4 h-4 mr-1",fill:"currentColor",viewBox:"0 0 24 24"},[e("path",{d:"M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413z"})],-1)),u(" "+i(t.no_whatsapp),1)],8,wa)):(n(),r("span",_a,"-"))]),e("td",Ma,[e("div",Ca,i(t.rt?`RT ${t.rt}`:"-")+" "+i(t.rt&&t.rw?"/":"")+" "+i(t.rw?`RW ${t.rw}`:""),1)]),e("td",Ba,[e("span",ja,[a[60]||(a[60]=e("svg",{class:"w-3 h-3 mr-1",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M5.05 4.05a7 7 0 119.9 9.9L10 18.9l-4.95-4.95a7 7 0 010-9.9zM10 11a2 2 0 100-4 2 2 0 000 4z","clip-rule":"evenodd"})],-1)),u(" "+i(t.wilayah||"Belum diset"),1)])]),e("td",Aa,[t.kategori==="sosial"?(n(),r("span",Sa,[...a[61]||(a[61]=[e("svg",{class:"w-3 h-3 mr-1",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{d:"M9 6a3 3 0 11-6 0 3 3 0 016 0zM17 6a3 3 0 11-6 0 3 3 0 016 0zM12.93 17c.046-.327.07-.66.07-1a6.97 6.97 0 00-1.5-4.33A5 5 0 0119 16v1h-6.07zM6 11a5 5 0 015 5v1H1v-1a5 5 0 015-5z"})],-1),u(" Sosial (Gratis) ",-1)])])):(n(),r("span",La,[...a[62]||(a[62]=[e("svg",{class:"w-3 h-3 mr-1",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{d:"M13 6a3 3 0 11-6 0 3 3 0 016 0zM18 8a2 2 0 11-4 0 2 2 0 014 0zM14 15a4 4 0 00-8 0v3h8v-3zM6 8a2 2 0 11-4 0 2 2 0 014 0zM16 18v-3a5.972 5.972 0 00-.75-2.906A3.005 3.005 0 0119 15v3h-3zM4.75 12.094A5.973 5.973 0 004 15v3H1v-3a3 3 0 013.75-2.906z"})],-1),u(" Umum ",-1)])]))]),e("td",za,[t.status_aktif?(n(),r("span",Ta,[...a[63]||(a[63]=[e("svg",{class:"w-3 h-3 mr-1",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z","clip-rule":"evenodd"})],-1),u(" Aktif ",-1)])])):(n(),r("span",Va,[...a[64]||(a[64]=[e("svg",{class:"w-3 h-3 mr-1",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z","clip-rule":"evenodd"})],-1),u(" Nonaktif ",-1)])]))]),e("td",Da,[t.kategori==="sosial"?(n(),r("div",Na,[a[65]||(a[65]=e("span",{class:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-purple-100 text-purple-800 mb-1"},[e("svg",{class:"w-3 h-3 mr-1",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z","clip-rule":"evenodd"})]),u(" Gratis ")],-1)),e("span",Pa,i(z(t).bulan),1)])):(n(),r("div",$a,[z(t).status==="SUDAH_BAYAR"?(n(),r("span",Ia,[...a[66]||(a[66]=[e("svg",{class:"w-3 h-3 mr-1",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z","clip-rule":"evenodd"})],-1),u(" Sudah Bayar ",-1)])])):z(t).status==="MENUNGGAK"||z(t).status==="TUNGGAKAN"?(n(),r("span",Ra,[...a[67]||(a[67]=[e("svg",{class:"w-3 h-3 mr-1",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z","clip-rule":"evenodd"})],-1),u(" Menunggak ",-1)])])):z(t).status==="CICILAN"?(n(),r("span",Ha,[...a[68]||(a[68]=[e("svg",{class:"w-3 h-3 mr-1",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M4 2a1 1 0 011 1v2.101a7.002 7.002 0 0111.601 2.566 1 1 0 11-1.885.666A5.002 5.002 0 005.999 7H9a1 1 0 010 2H4a1 1 0 01-1-1V3a1 1 0 011-1zm.008 9.057a1 1 0 011.276.61A5.002 5.002 0 0014.001 13H11a1 1 0 110-2h5a1 1 0 011 1v5a1 1 0 11-2 0v-2.101a7.002 7.002 0 01-11.601-2.566 1 1 0 01.61-1.276z","clip-rule":"evenodd"})],-1),u(" Cicilan ",-1)])])):(n(),r("span",Fa,[...a[69]||(a[69]=[e("svg",{class:"w-3 h-3 mr-1",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z","clip-rule":"evenodd"})],-1),u(" Belum Bayar ",-1)])])),e("span",Ua,i(z(t).bulan),1)]))]),e("td",Ea,[t.foto_rumah_url?(n(),r("button",{key:0,onClick:o=>Me(t),class:"inline-flex items-center px-3 py-1 bg-blue-600 text-white rounded-lg text-xs hover:bg-blue-700 transition"},[...a[70]||(a[70]=[e("svg",{class:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1),u(" Lihat Foto ",-1)])],8,Ga)):(n(),r("span",Ya,"Tidak ada foto"))]),e("td",Wa,[t.has_coordinates?(n(),J(T(V),{key:0,href:`/peta?pelanggan=${t.id_pelanggan}`,class:"inline-flex items-center text-blue-800 hover:text-blue-900 font-medium"},{default:A(()=>[...a[71]||(a[71]=[e("svg",{class:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})],-1),u(" Lihat Peta ",-1)])]),_:1},8,["href"])):(n(),r("span",Ka,"Tidak ada koordinat"))]),e("td",Oa,[t.google_maps_url?(n(),r("a",{key:0,href:t.google_maps_url,target:"_blank",rel:"noopener noreferrer",class:"inline-flex items-center text-blue-600 hover:text-blue-900 font-medium"},[...a[72]||(a[72]=[e("svg",{class:"w-4 h-4 mr-1",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{d:"M11 3a1 1 0 100 2h2.586l-6.293 6.293a1 1 0 101.414 1.414L15 6.414V9a1 1 0 102 0V4a1 1 0 00-1-1h-5z"}),e("path",{d:"M5 5a2 2 0 00-2 2v8a2 2 0 002 2h8a2 2 0 002-2v-3a1 1 0 10-2 0v3H5V7h3a1 1 0 000-2H5z"})],-1),u(" Buka Maps ",-1)])],8,Ja)):t.has_coordinates?(n(),r("a",{key:1,href:t.google_maps_link,target:"_blank",rel:"noopener noreferrer",class:"inline-flex items-center text-blue-600 hover:text-blue-900 font-medium"},[...a[73]||(a[73]=[e("svg",{class:"w-4 h-4 mr-1",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{d:"M11 3a1 1 0 100 2h2.586l-6.293 6.293a1 1 0 101.414 1.414L15 6.414V9a1 1 0 102 0V4a1 1 0 00-1-1h-5z"}),e("path",{d:"M5 5a2 2 0 00-2 2v8a2 2 0 002 2h8a2 2 0 002-2v-3a1 1 0 10-2 0v3H5V7h3a1 1 0 000-2H5z"})],-1),u(" Buka Maps ",-1)])],8,qa)):(n(),r("span",Qa,"-"))]),s.$page.props.auth?.user?(n(),r("td",Xa,[e("div",Za,[e("a",{href:`/pelanggan/${t.id}/download-qr`,target:"_blank",class:"text-green-600 hover:text-green-800 transition",title:"Download QR Code"},[...a[74]||(a[74]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v1m6 11h2m-6 0h-2v4m0-11v3m0 0h.01M12 12h4.01M16 20h4M4 12h4m12 0h.01M5 8h2a1 1 0 001-1V5a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1zm12 0h2a1 1 0 001-1V5a1 1 0 00-1-1h-2a1 1 0 00-1 1v2a1 1 0 001 1zM5 20h2a1 1 0 001-1v-2a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1z"})],-1)])],8,et),e("button",{onClick:o=>ce(t),class:"text-purple-600 hover:text-purple-800 transition",title:"Riwayat Pembayaran"},[...a[75]||(a[75]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17 9V7a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2m2 4h10a2 2 0 002-2v-6a2 2 0 00-2-2H9a2 2 0 00-2 2v6a2 2 0 002 2zm7-5a2 2 0 11-4 0 2 2 0 014 0z"})],-1)])],8,at),U(T(V),{href:`/pelanggan/${t.id}/edit`,class:"text-blue-600 hover:text-blue-800 transition",title:"Edit"},{default:A(()=>[...a[76]||(a[76]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1)])]),_:1},8,["href"]),e("button",{onClick:o=>Ae(t),class:"text-red-600 hover:text-red-800 transition",title:"Hapus"},[...a[77]||(a[77]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)])],8,tt)])])):p("",!0)]))),128))])])])]),X.value?(n(),r("div",{key:1,class:"fixed inset-0 z-50 overflow-y-auto",onClick:de(re,["self"])},[e("div",st,[a[127]||(a[127]=e("div",{class:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity"},null,-1)),e("div",lt,[e("div",nt,[e("h3",rt,"Riwayat Pembayaran - "+i(x.value?.nama_pelanggan),1),e("button",{onClick:re,class:"text-white hover:text-gray-200 p-1"},[...a[78]||(a[78]=[e("svg",{class:"w-5 h-5 sm:w-6 sm:h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),e("div",ot,[e("div",it,[a[103]||(a[103]=e("h4",{class:"text-base sm:text-lg font-semibold mb-3 sm:mb-4"},"Tambah Pembayaran Baru",-1)),x.value?.kategori!=="sosial"&&!z(x.value).sudah_bayar?(n(),r("div",ut,[e("div",dt,[a[82]||(a[82]=e("svg",{class:"w-5 h-5 text-yellow-600 mr-2 mt-0.5",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z","clip-rule":"evenodd"})],-1)),e("div",null,[a[81]||(a[81]=e("p",{class:"text-sm font-bold text-yellow-800 mb-1"},"Pelanggan Belum Bayar Bulan Ini",-1)),e("p",pt,[a[79]||(a[79]=u(" Bulan: ",-1)),e("strong",null,i(z(x.value).bulan),1),a[80]||(a[80]=u(". Silakan input pembayaran untuk bulan ini atau bulan lainnya. ",-1))])])])])):p("",!0),x.value?.kategori==="sosial"?(n(),r("div",mt,[...a[83]||(a[83]=[e("div",{class:"flex items-center"},[e("svg",{class:"w-5 h-5 text-purple-600 mr-2",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z","clip-rule":"evenodd"})]),e("span",{class:"text-sm font-medium text-purple-800"},"Pelanggan Kategori Sosial - Tidak Dikenakan Biaya (Gratis)")],-1)])])):p("",!0),I.value?(n(),J(Te,{key:2,"total-tagihan":I.value.total_tagihan||0,"jumlah-terbayar":I.value.jumlah_terbayar||0,"status-bayar":I.value.status_bayar||"BELUM_BAYAR",class:"mb-4"},null,8,["total-tagihan","jumlah-terbayar","status-bayar"])):p("",!0),v.value.length>0?(n(),r("div",gt,[a[86]||(a[86]=e("h5",{class:"font-bold text-amber-900 mb-2 flex items-center gap-2"},[e("svg",{class:"w-5 h-5 text-amber-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})]),u(" Info Tunggakan "),e("span",{class:"ml-auto text-xs font-normal bg-amber-100 text-amber-700 border border-amber-300 px-2 py-0.5 rounded-full"},"Opsional")],-1)),a[87]||(a[87]=e("p",{class:"text-xs text-amber-700 mb-3"},[u("Pelanggan ini memiliki tunggakan dari bulan sebelumnya. Pembayaran tunggakan "),e("strong",null,"tidak wajib"),u(" dilakukan sekarang â€” bisa dibayar kapan saja.")],-1)),e("div",bt,[(n(!0),r(j,null,Y(v.value,t=>(n(),r("div",{key:t.id,class:"flex justify-between py-1 border-b border-amber-100 last:border-0"},[e("span",xt,i(ue(t.bulan)),1),e("span",vt,"Rp "+i(Number(t.sisa_tagihan).toLocaleString("id-ID")),1)]))),128)),e("div",ct,[a[84]||(a[84]=e("span",{class:"text-amber-800"},"Total Tunggakan:",-1)),e("span",ht,"Rp "+i(Number(v.value.reduce((t,o)=>t+o.sisa_tagihan,0)).toLocaleString("id-ID")),1)])]),l.value.bayar_tunggakan&&v.value.length>0?(n(),r("div",ft,[a[85]||(a[85]=e("label",{class:"block text-sm font-medium text-amber-800 mb-1"},[u(" Jumlah Tunggakan yang Dibayar (Rp) "),e("span",{class:"text-amber-600 text-xs font-normal"},"â€” Bisa dicicil")],-1)),y(e("input",{type:"number","onUpdate:modelValue":a[10]||(a[10]=t=>l.value.jumlah_bayar_tunggakan=t),onInput:M,step:"1000",min:"0",max:v.value.reduce((t,o)=>t+o.sisa_tagihan,0),class:"w-full px-3 py-2 border border-amber-300 rounded-lg focus:ring-2 focus:ring-amber-500 bg-white text-sm",placeholder:"Maks: Rp "+Number(v.value.reduce((t,o)=>t+o.sisa_tagihan,0)).toLocaleString("id-ID")},null,40,yt),[[S,l.value.jumlah_bayar_tunggakan]]),e("p",kt,"ðŸ’¡ Bisa diisi sebagian untuk cicil (misal: Rp 5.000 dari total Rp "+i(Number(v.value.reduce((t,o)=>t+o.sisa_tagihan,0)).toLocaleString("id-ID"))+")",1)])):p("",!0)])):p("",!0),e("div",wt,[e("div",_t,[a[88]||(a[88]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Bulan Bayar",-1)),e("div",Mt,[y(e("input",{type:"month","onUpdate:modelValue":a[11]||(a[11]=t=>l.value.bulan_bayar=t),class:"block w-full rounded-md border-gray-300 focus:border-blue-500 focus:ring-blue-500 sm:text-sm p-2 bg-white"},null,512),[[S,l.value.bulan_bayar]])]),h.value.bulan_bayar?(n(),r("p",Ct,i(h.value.bulan_bayar),1)):p("",!0)]),e("div",Bt,[a[89]||(a[89]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Tanggal Bayar",-1)),e("div",jt,[y(e("input",{type:"date","onUpdate:modelValue":a[12]||(a[12]=t=>l.value.tanggal_bayar=t),class:"block w-full rounded-md border-gray-300 focus:border-blue-500 focus:ring-blue-500 sm:text-sm p-2 bg-white"},null,512),[[S,l.value.tanggal_bayar]])]),h.value.tanggal_bayar?(n(),r("p",At,i(h.value.tanggal_bayar),1)):p("",!0)]),!l.value.meteran_sebelum&&!l.value.meteran_sesudah?(n(),r("div",St,[...a[90]||(a[90]=[e("div",{class:"flex items-start gap-3"},[e("svg",{class:"h-5 w-5 text-yellow-600 mt-0.5 flex-shrink-0",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z","clip-rule":"evenodd"})]),e("div",{class:"text-sm"},[e("p",{class:"font-semibold text-yellow-800 mb-1"},"Data Meteran Belum Tersedia"),e("p",{class:"text-yellow-700"},[u("Meteran untuk bulan ini belum diinput. Silakan input data meteran air terlebih dahulu menggunakan "),e("strong",null,"QR Scanner"),u(" atau isi manual di form ini.")])])],-1)])])):p("",!0),e("div",Lt,[a[91]||(a[91]=e("label",{class:"block text-sm font-medium text-gray-700"},"Meteran Sebelum",-1)),y(e("input",{type:"number","onUpdate:modelValue":a[13]||(a[13]=t=>l.value.meteran_sebelum=t),step:"0.01",placeholder:"0.00",class:"block w-full rounded-md border-gray-300 focus:border-blue-500 focus:ring-blue-500 sm:text-sm p-2 bg-white",onInput:M},null,544),[[S,l.value.meteran_sebelum]]),h.value.meteran_sebelum?(n(),r("p",zt,i(h.value.meteran_sebelum),1)):p("",!0),a[92]||(a[92]=e("p",{class:"text-xs text-gray-500"},"Angka meteran bulan lalu",-1))]),e("div",Tt,[a[93]||(a[93]=e("label",{class:"block text-sm font-medium text-gray-700"},"Meteran Sesudah",-1)),y(e("input",{type:"number","onUpdate:modelValue":a[14]||(a[14]=t=>l.value.meteran_sesudah=t),step:"0.01",placeholder:"0.00",class:"block w-full rounded-md border-gray-300 focus:border-blue-500 focus:ring-blue-500 sm:text-sm p-2 bg-white",onInput:M},null,544),[[S,l.value.meteran_sesudah]]),h.value.meteran_sesudah?(n(),r("p",Vt,i(h.value.meteran_sesudah),1)):p("",!0),a[94]||(a[94]=e("p",{class:"text-xs text-gray-500"},"Angka meteran bulan ini",-1))]),e("div",null,[a[95]||(a[95]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Pemakaian (mÂ³)",-1)),y(e("input",{type:"number","onUpdate:modelValue":a[15]||(a[15]=t=>l.value.jumlah_kubik=t),step:"0.01",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-800 focus:border-transparent bg-gray-50",readonly:""},null,512),[[S,l.value.jumlah_kubik]]),h.value.jumlah_kubik?(n(),r("p",Dt,i(h.value.jumlah_kubik),1)):p("",!0),x.value?.kategori==="sosial"?(n(),r("p",Nt,"Tarif: Gratis (Kategori Sosial)")):(n(),r("p",Pt,"Tarif: Rp 2.000 / mÂ³"))]),e("div",null,[e("label",$t,[y(e("input",{type:"checkbox","onUpdate:modelValue":a[16]||(a[16]=t=>l.value.abunemen=t),onChange:M,class:"w-5 h-5 text-blue-800 border-gray-300 rounded focus:ring-2 focus:ring-blue-800"},null,544),[[pe,l.value.abunemen]]),a[96]||(a[96]=e("div",null,[e("span",{class:"text-sm font-medium text-gray-700"},"Abunemen"),e("p",{class:"text-xs text-gray-500"},"Biaya tambahan: Rp 3.000")],-1))])]),e("div",null,[e("label",It,[y(e("input",{type:"checkbox","onUpdate:modelValue":a[17]||(a[17]=t=>l.value.bayar_tunggakan=t),onChange:ge,class:"w-5 h-5 text-amber-600 border-gray-300 rounded focus:ring-2 focus:ring-amber-500"},null,544),[[pe,l.value.bayar_tunggakan]]),e("div",null,[a[97]||(a[97]=e("span",{class:"text-sm font-medium text-gray-700"},"Bayar Tunggakan",-1)),e("p",Rt,i(v.value.length>0?"Total: Rp "+Number(v.value.reduce((t,o)=>t+(o.sisa_tagihan||0),0)).toLocaleString("id-ID"):"(Rp 0 - Tidak Ada Tunggakan)"),1)])])]),e("div",null,[e("label",Ht,[u(i(l.value.status_bayar==="CICILAN"?"Jumlah Cicilan":"Total Tagihan")+" (Rp) ",1),l.value.status_bayar==="CICILAN"?(n(),r("span",Ft,"- Bisa diedit")):p("",!0)]),y(e("input",{type:"number","onUpdate:modelValue":a[18]||(a[18]=t=>l.value.jumlah_bayar=t),step:"1000",min:"0",class:se(["w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-800 focus:border-transparent",l.value.status_bayar==="CICILAN"?"bg-white":"bg-gray-50"]),readonly:l.value.status_bayar!=="CICILAN"},null,10,Ut),[[S,l.value.jumlah_bayar]]),h.value.jumlah_bayar?(n(),r("p",Et,i(h.value.jumlah_bayar),1)):p("",!0),l.value.status_bayar==="CICILAN"?(n(),r("p",Gt,"ðŸ’¡ Untuk cicilan, isi jumlah berapa saja (misal: Rp 1.000, Rp 5.000, dll)")):p("",!0)]),e("div",null,[a[100]||(a[100]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[u("Status Bayar "),e("span",{class:"text-red-500"},"*")],-1)),y(e("select",{"onUpdate:modelValue":a[19]||(a[19]=t=>l.value.status_bayar=t),onChange:M,class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-800 focus:border-transparent",required:""},[...a[98]||(a[98]=[e("option",{value:"BELUM_BAYAR"},"Belum Bayar - Bulan ini belum dibayar",-1),e("option",{value:"CICILAN"},"Cicilan - Bayar sebagian dulu",-1),e("option",{value:"SUDAH_BAYAR"},"Sudah Bayar - Lunas penuh",-1),e("option",{value:"TUNGGAKAN"},"Tunggakan - Input bulan lalu yang nunggak",-1)])],544),[[q,l.value.status_bayar]]),e("p",Yt,[a[99]||(a[99]=u(" Pilih sesuai kondisi pembayaran. ",-1)),l.value.status_bayar==="TUNGGAKAN"?(n(),r("span",Wt," ðŸ’¡ Status Tunggakan akan mengosongkan jumlah bayar agar tercatat sebagai hutang di bulan berikutnya. ")):p("",!0)])]),e("div",null,[a[101]||(a[101]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Catatan",-1)),y(e("input",{type:"text","onUpdate:modelValue":a[20]||(a[20]=t=>l.value.keterangan=t),class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-800 focus:border-transparent",placeholder:"Misal: Bayar di warung, Cicilan ke-2, dll (opsional)",maxlength:"255"},null,512),[[S,l.value.keterangan]]),a[102]||(a[102]=e("p",{class:"text-xs text-gray-500 mt-1"}," Catatan tambahan (tidak wajib) ",-1))])]),e("button",{onClick:fe,disabled:K.value,class:"mt-3 sm:mt-4 w-full sm:w-auto px-4 py-2 text-sm sm:text-base bg-blue-800 text-white rounded-lg hover:bg-blue-900 active:bg-blue-950 disabled:bg-gray-400 transition touch-manipulation"},i(K.value?"Menyimpan...":"Simpan Pembayaran"),9,Kt)]),e("div",null,[a[126]||(a[126]=e("h4",{class:"text-base sm:text-lg font-semibold mb-3 sm:mb-4"},"Daftar Pembayaran",-1)),Z.value?(n(),r("div",Ot,[...a[104]||(a[104]=[e("p",{class:"text-gray-500 text-sm"},"Memuat data...",-1)])])):k.value.length===0?(n(),r("div",Jt,[...a[105]||(a[105]=[e("svg",{class:"mx-auto h-10 w-10 sm:h-12 sm:w-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1),e("p",{class:"mt-2 text-gray-500 text-sm"},"Belum ada riwayat pembayaran",-1)])])):(n(),r("div",qt,[e("div",Qt,[e("div",Xt,[e("div",Zt,i(k.value.length),1),a[106]||(a[106]=e("div",{class:"text-xs text-gray-500 mt-0.5"},"Total Transaksi",-1))]),e("div",es,[e("div",as,"Rp "+i(Number(k.value.reduce((t,o)=>t+Number(o.jumlah_bayar||0),0)).toLocaleString("id-ID")),1),a[107]||(a[107]=e("div",{class:"text-xs text-gray-500 mt-0.5"},"Total Dibayar",-1))]),e("div",ts,[e("div",ss,[u(i(k.value.reduce((t,o)=>t+Number(o.jumlah_kubik||0),0).toFixed(1))+" ",1),a[108]||(a[108]=e("span",{class:"text-sm font-normal"},"mÂ³",-1))]),a[109]||(a[109]=e("div",{class:"text-xs text-gray-500 mt-0.5"},"Total Pemakaian",-1))])]),e("div",ls,[(n(!0),r(j,null,Y(k.value,t=>(n(),r("div",{key:t.id,class:"border border-gray-200 rounded-xl overflow-hidden hover:border-blue-300 hover:shadow-md transition-all duration-200 bg-white"},[e("div",ns,[e("div",rs,[a[110]||(a[110]=e("div",{class:"w-9 h-9 rounded-full bg-white/20 flex items-center justify-center flex-shrink-0"},[e("svg",{class:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17 9V7a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2m2 4h10a2 2 0 002-2v-6a2 2 0 00-2-2H9a2 2 0 00-2 2v6a2 2 0 002 2zm7-5a2 2 0 11-4 0 2 2 0 014 0z"})])],-1)),e("div",null,[e("div",os,i(ue(t.bulan_bayar)),1),e("div",is,"Tgl Bayar: "+i(je(t.tanggal_bayar)),1)])]),e("div",us,[e("span",{class:se(["px-2.5 py-1 rounded-full text-[10px] sm:text-xs font-bold uppercase tracking-wider shadow-sm",t.status_tagihan==="SUDAH_BAYAR"?"bg-green-500 text-white":t.status_tagihan==="CICILAN"?"bg-yellow-400 text-white":t.status_tagihan==="TUNGGAKAN"?"bg-red-500 text-white":"bg-gray-400 text-white"])},[t.status_tagihan==="SUDAH_BAYAR"?(n(),r(j,{key:0},[u("âœ“ Sudah Bayar")],64)):t.status_tagihan==="CICILAN"?(n(),r(j,{key:1},[u("âš  Cicilan")],64)):t.status_tagihan==="TUNGGAKAN"?(n(),r(j,{key:2},[u("âœ– Tunggakan")],64)):(n(),r(j,{key:3},[u("â—‹ Belum Bayar")],64))],2),e("div",ds,"#"+i(t.id),1)])]),e("div",ps,[e("div",ms,[e("div",null,[a[116]||(a[116]=e("div",{class:"text-xs font-semibold text-gray-400 uppercase tracking-wider mb-2 flex items-center gap-1"},[e("svg",{class:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})]),u(" Data Meteran Air ")],-1)),e("div",gs,[e("div",bs,[e("div",xs,[a[111]||(a[111]=e("div",{class:"text-xs text-gray-400 mb-0.5"},"Stand Awal",-1)),e("div",vs,i(t.meteran_sebelum!==null?Number(t.meteran_sebelum).toFixed(1):"â€”"),1)]),e("div",cs,[a[112]||(a[112]=e("svg",{class:"w-5 h-5 text-blue-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2.5",d:"M13 7l5 5m0 0l-5 5m5-5H6"})],-1)),e("div",hs,i(t.jumlah_kubik?"+"+Number(t.jumlah_kubik).toFixed(1):"â€”"),1)]),e("div",fs,[a[113]||(a[113]=e("div",{class:"text-xs text-gray-400 mb-0.5"},"Stand Akhir",-1)),e("div",ys,i(t.meteran_sesudah!==null?Number(t.meteran_sesudah).toFixed(1):"â€”"),1)])]),e("div",ks,[a[114]||(a[114]=e("span",{class:"text-xs text-blue-600 font-medium"},"Pemakaian bulan ini: ",-1)),e("span",ws,i(t.jumlah_kubik?Number(t.jumlah_kubik).toFixed(1)+" mÂ³":"â€”"),1)])]),t.created_at?(n(),r("div",_s,[a[115]||(a[115]=e("svg",{class:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),u(" Diinput sistem: "+i(t.created_at),1)])):p("",!0)]),e("div",null,[a[121]||(a[121]=e("div",{class:"text-xs font-semibold text-gray-400 uppercase tracking-wider mb-2 flex items-center gap-1"},[e("svg",{class:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17 9V7a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2m2 4h10a2 2 0 002-2v-6a2 2 0 00-2-2H9a2 2 0 00-2 2v6a2 2 0 002 2zm7-5a2 2 0 11-4 0 2 2 0 014 0z"})]),u(" Rincian Tagihan ")],-1)),e("div",Ms,[e("div",Cs,[e("div",null,[a[117]||(a[117]=e("div",{class:"text-sm text-gray-700 font-medium flex items-center gap-1.5"},[e("span",{class:"w-2.5 h-2.5 rounded-full bg-blue-500 inline-block"}),u(" Biaya Pemakaian Air ")],-1)),t.jumlah_kubik&&t.tarif_per_kubik?(n(),r("div",Bs,i(Number(t.jumlah_kubik).toFixed(1))+" mÂ³ Ã— Rp "+i(Number(t.tarif_per_kubik).toLocaleString("id-ID"))+"/mÂ³ ",1)):p("",!0)]),e("div",js,"Rp "+i(Number(t.biaya_air||0).toLocaleString("id-ID")),1)]),e("div",As,[a[118]||(a[118]=e("div",null,[e("div",{class:"text-sm text-gray-700 font-medium flex items-center gap-1.5"},[e("span",{class:"w-2.5 h-2.5 rounded-full bg-purple-500 inline-block"}),u(" Abunemen ")]),e("div",{class:"text-xs text-gray-400 mt-0.5 pl-4"},"Iuran tetap bulanan")],-1)),e("div",{class:se(["text-sm font-semibold",t.abunemen?"text-gray-800":"text-gray-400"])},i(t.abunemen?"Rp "+Number(t.abunemen_nominal||0).toLocaleString("id-ID"):"â€” (Tidak)"),3)]),t.tunggakan>0?(n(),r("div",Ss,[a[119]||(a[119]=e("div",null,[e("div",{class:"text-sm text-red-700 font-bold flex items-center gap-1.5"},[e("svg",{class:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z","clip-rule":"evenodd"})]),u(" Pelunasan Tunggakan ")]),e("div",{class:"text-[10px] text-red-500 mt-0.5 pl-5 font-medium italic"},"Tagihan dari bulan-bulan sebelumnya")],-1)),e("div",Ls,"Rp "+i(Number(t.tunggakan).toLocaleString("id-ID")),1)])):p("",!0),e("div",zs,[a[120]||(a[120]=e("div",{class:"text-sm font-bold text-white"},"TOTAL DIBAYAR",-1)),e("div",Ts,"Rp "+i(Number(t.jumlah_bayar).toLocaleString("id-ID")),1)])])])])]),e("div",Vs,[e("div",Ds,"ID Transaksi: #"+i(t.id),1),e("div",Ns,[e("button",{onClick:o=>ke(t.id),class:"flex-1 sm:flex-none flex items-center justify-center gap-1.5 px-3 py-1.5 text-xs font-bold bg-blue-50 text-blue-700 hover:bg-blue-100 rounded-lg transition border border-blue-100 whitespace-nowrap",title:"Kirim Struk via WhatsApp"},[...a[122]||(a[122]=[e("svg",{class:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 19l9 2-9-18-9 18 9-2zm0 0v-8"})],-1),u(" WA ",-1)])],8,Ps),e("button",{onClick:o=>we(t.id),class:"flex-1 sm:flex-none flex items-center justify-center gap-1.5 px-3 py-1.5 text-xs font-bold bg-green-50 text-green-700 hover:bg-green-100 rounded-lg transition border border-green-100 whitespace-nowrap",title:"Download PDF"},[...a[123]||(a[123]=[e("svg",{class:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1),u(" PDF ",-1)])],8,$s),e("button",{onClick:o=>_e(t.id),class:"flex-1 sm:flex-none flex items-center justify-center gap-1.5 px-3 py-1.5 text-xs font-bold bg-purple-50 text-purple-700 hover:bg-purple-100 rounded-lg transition border border-purple-100 whitespace-nowrap",title:"Cetak Struk"},[...a[124]||(a[124]=[e("svg",{class:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z"})],-1),u(" Cetak ",-1)])],8,Is),e("button",{onClick:o=>ye(t.id),class:"flex-1 sm:flex-none flex items-center justify-center gap-1.5 px-3 py-1.5 text-xs font-bold bg-red-50 text-red-700 hover:bg-red-100 rounded-lg transition border border-red-100 whitespace-nowrap",title:"Hapus"},[...a[125]||(a[125]=[e("svg",{class:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1),u(" Hapus ",-1)])],8,Rs)])])]))),128))])]))])])])])])):p("",!0)])])]),_:1}),W.value?(n(),r("div",{key:0,class:"fixed inset-0 z-50 overflow-y-auto",onClick:a[23]||(a[23]=t=>W.value=!1)},[e("div",Hs,[a[138]||(a[138]=e("div",{class:"fixed inset-0 transition-opacity bg-gray-500 bg-opacity-75"},null,-1)),a[139]||(a[139]=e("span",{class:"hidden sm:inline-block sm:align-middle sm:h-screen"},"â€‹",-1)),e("div",{class:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-4xl sm:w-full",onClick:a[22]||(a[22]=de(()=>{},["stop"]))},[e("div",Fs,[e("div",Us,[e("h3",Es," Foto Rumah - "+i(C.value?.nama_pelanggan),1),e("button",{onClick:a[21]||(a[21]=t=>W.value=!1),class:"text-gray-400 hover:text-gray-600"},[...a[128]||(a[128]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),C.value?.foto_rumah_url&&!E.value?(n(),r("div",Gs,[$.value?(n(),r("div",Ys,[...a[129]||(a[129]=[e("div",{class:"text-center"},[e("div",{class:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-2"}),e("p",{class:"text-sm text-gray-600"},"Memuat foto...")],-1)])])):p("",!0),e("img",{src:C.value.foto_rumah_url,alt:`Foto Rumah ${C.value.nama_pelanggan}`,class:"w-full h-auto rounded-lg border border-gray-200",onLoad:Ce,onError:Be},null,40,Ws)])):E.value?(n(),r("div",Ks,[a[130]||(a[130]=e("svg",{class:"w-16 h-16 mx-auto text-red-400 mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})],-1)),a[131]||(a[131]=e("h3",{class:"text-lg font-medium text-red-900 mb-2"},"Foto Tidak Dapat Dimuat",-1)),e("p",Os,i(Q.value),1),a[132]||(a[132]=e("p",{class:"text-xs text-gray-600"},"File mungkin tidak ada atau storage link belum dibuat.",-1))])):(n(),r("div",Js,[...a[133]||(a[133]=[e("svg",{class:"w-16 h-16 mx-auto text-gray-400 mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1),e("p",{class:"text-gray-600"},"Tidak ada foto rumah",-1)])])),e("div",qs,[e("div",Qs,[e("p",null,[a[134]||(a[134]=e("span",{class:"font-semibold"},"ID Pelanggan:",-1)),u(" "+i(C.value?.id_pelanggan),1)]),e("p",null,[a[135]||(a[135]=e("span",{class:"font-semibold"},"NIK:",-1)),u(" "+i(C.value?.nik||"-"),1)]),e("p",null,[a[136]||(a[136]=e("span",{class:"font-semibold"},"Wilayah:",-1)),u(" "+i(C.value?.wilayah),1)])]),C.value?.foto_rumah_url&&!E.value?(n(),r("a",{key:0,href:C.value.foto_rumah_url,download:"",class:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition inline-flex items-center"},[...a[137]||(a[137]=[e("svg",{class:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})],-1),u(" Download ",-1)])],8,Xs)):p("",!0)])])])])])):p("",!0)],64))}};export{sl as default};
